# 06. 실습: 포켓몬 검색기 만들기

#실습 #fetch #async #await #dom

지금까지 배운 비동기 처리 개념(`async/await`, `fetch`)과 DOM 조작을 활용하여 간단한 '포켓몬 검색기'를 만들어 보겠습니다. 사용자가 포켓몬 이름을 입력하고 검색 버튼을 누르면, [PokeAPI](https://pokeapi.co/)에서 해당 포켓몬의 정보를 가져와 화면에 표시하는 애플리케이션입니다.

---

## 1. 최종 목표

- 사용자가 포켓몬 이름을 입력하고 '검색' 버튼을 클릭합니다.
- `fetch`를 사용해 PokeAPI에 비동기적으로 데이터를 요청합니다.
- 응답받은 데이터를 사용하여 포켓몬의 이름, 이미지, 기본 스탯을 화면에 표시합니다.
- 에러가 발생하거나 포켓몬을 찾지 못한 경우, 적절한 메시지를 보여줍니다.

![Pokemon Searcher Demo](https://raw.githubusercontent.com/notlikelion/250826_async/main/pokemon.gif)

---

## 2. 기본 구조 (HTML & CSS)

먼저, 검색 필드, 버튼, 그리고 결과를 표시할 영역을 포함하는 기본 HTML 구조를 작성합니다.

### `index.html`

```html
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>포켓몬 검색기</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h1>포켓몬 검색기</h1>
      <div class="search-box">
        <input
          type="text"
          id="pokemon-name-input"
          placeholder="포켓몬 이름을 입력하세요"
        />
        <button id="search-button">검색</button>
      </div>
      <div id="pokemon-info" class="pokemon-info-card">
        <!-- 포켓몬 정보가 여기에 표시됩니다 -->
      </div>
    </div>
    <script src="script.js"></script>
  </body>
</html>
```

### `style.css`

간단한 스타일을 적용하여 보기 좋게 만듭니다.

```css
body {
  font-family: sans-serif;
  background-color: #f4f4f4;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.container {
  background-color: white;
  padding: 2rem;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  text-align: center;
  width: 320px;
}

.search-box {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
}

#pokemon-name-input {
  flex-grow: 1;
  padding: 0.5rem;
  border: 1px solid #ccc;
  border-radius: 5px;
}

#search-button {
  padding: 0.5rem 1rem;
  background-color: #007bff;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

#search-button:hover {
  background-color: #0056b3;
}

.pokemon-info-card {
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 1rem;
  min-height: 200px;
}

.pokemon-info-card h2 {
  margin-top: 0;
  text-transform: capitalize;
}

.pokemon-info-card img {
  width: 120px;
  height: 120px;
}
```

---

## 3. 자바스크립트 로직 (`script.js`)

이제 비동기 통신과 DOM 조작을 담당하는 자바스크립트 코드를 작성합니다.

### 가. 요소 선택 및 이벤트 리스너 등록

먼저 필요한 HTML 요소들을 가져오고, '검색' 버튼에 클릭 이벤트 리스너를 추가합니다.

```javascript
const searchButton = document.getElementById("search-button");
const nameInput = document.getElementById("pokemon-name-input");
const infoCard = document.getElementById("pokemon-info");

searchButton.addEventListener("click", () => {
  const pokemonName = nameInput.value.toLowerCase().trim();
  if (pokemonName) {
    fetchPokemonData(pokemonName);
  } else {
    infoCard.innerHTML = "<p>포켓몬 이름을 입력해주세요.</p>";
  }
});
```

### 나. 데이터 요청 및 처리 함수 (`fetchPokemonData`)

이 함수가 실습의 핵심입니다. `async/await`를 사용하여 API로부터 데이터를 가져옵니다.

```javascript
async function fetchPokemonData(pokemonName) {
  const url = `https://pokeapi.co/api/v2/pokemon/${pokemonName}`;

  // 로딩 상태 표시
  infoCard.innerHTML = "<p>데이터를 불러오는 중...</p>";

  try {
    const response = await fetch(url);

    if (!response.ok) {
      // 404 Not Found 등 에러 처리
      throw new Error("해당 포켓몬을 찾을 수 없습니다.");
    }

    const data = await response.json();
    displayPokemonInfo(data);
  } catch (error) {
    // 네트워크 에러 또는 위에서 던진 에러 처리
    infoCard.innerHTML = `<p>${error.message}</p>`;
  }
}
```

### 다. 정보 표시 함수 (`displayPokemonInfo`)

API로부터 성공적으로 받은 데이터를 HTML로 변환하여 화면에 렌더링합니다.

```javascript
function displayPokemonInfo(data) {
  const name = data.name;
  // 공식 아트워크 이미지를 사용
  const imageUrl = data.sprites.other["official-artwork"].front_default;
  const types = data.types.map((typeInfo) => typeInfo.type.name).join(", ");
  const height = data.height / 10; // decimetres -> metres
  const weight = data.weight / 10; // hectograms -> kilograms

  infoCard.innerHTML = `
        <h2>${name}</h2>
        <img src="${imageUrl}" alt="${name}">
        <p><strong>타입:</strong> ${types}</p>
        <p><strong>키:</strong> ${height} m</p>
        <p><strong>몸무게:</strong> ${weight} kg</p>
    `;
}
```

### 라. 전체 `script.js` 코드

```javascript
document.addEventListener("DOMContentLoaded", () => {
  const searchButton = document.getElementById("search-button");
  const nameInput = document.getElementById("pokemon-name-input");
  const infoCard = document.getElementById("pokemon-info");

  // 검색 버튼 클릭 이벤트
  searchButton.addEventListener("click", handleSearch);

  // 엔터 키 입력 이벤트
  nameInput.addEventListener("keyup", (event) => {
    if (event.key === "Enter") {
      handleSearch();
    }
  });

  function handleSearch() {
    const pokemonName = nameInput.value.toLowerCase().trim();
    if (pokemonName) {
      fetchPokemonData(pokemonName);
    } else {
      infoCard.innerHTML = "<p>포켓몬 이름을 입력해주세요.</p>";
    }
  }

  async function fetchPokemonData(pokemonName) {
    const url = `https://pokeapi.co/api/v2/pokemon/${pokemonName}`;
    infoCard.innerHTML = "<p>데이터를 불러오는 중...</p>";

    try {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error("해당 포켓몬을 찾을 수 없습니다.");
      }
      const data = await response.json();
      displayPokemonInfo(data);
    } catch (error) {
      infoCard.innerHTML = `<p>${error.message}</p>`;
    }
  }

  function displayPokemonInfo(data) {
    const name = data.name;
    const imageUrl = data.sprites.other["official-artwork"].front_default;
    const types = data.types.map((typeInfo) => typeInfo.type.name).join(", ");
    const height = data.height / 10;
    const weight = data.weight / 10;

    infoCard.innerHTML = `
            <h2>${name}</h2>
            <img src="${imageUrl}" alt="${name}">
            <p><strong>타입:</strong> ${types}</p>
            <p><strong>키:</strong> ${height} m</p>
            <p><strong>몸무게:</strong> ${weight} kg</p>
        `;
  }
});
```

이 실습을 통해 비동기 데이터 요청부터 화면에 그리기까지의 전체적인 흐름을 경험할 수 있습니다.
