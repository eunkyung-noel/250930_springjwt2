# 04. 이벤트 처리

#이벤트 #event #이벤트처리 #event-handling #이벤트리스너 #event-listener

이벤트(Event)는 웹 페이지에서 사용자의 행동(클릭, 키보드 입력 등)이나 브라우저의 상태 변화(로딩 완료 등) 같은 '사건'을 의미합니다. JavaScript는 이러한 이벤트를 감지하고 그에 반응하여 특정 코드를 실행하는 **이벤트 기반 프로그래밍** 모델을 따릅니다.

---

## 1. 이벤트 처리 기본: `addEventListener`

`element.addEventListener(type, listener)`는 특정 요소(`element`)에 지정된 타입(`type`)의 이벤트가 발생했을 때, `listener` 함수를 실행하도록 등록하는 가장 표준적이고 권장되는 방식입니다.

```javascript
const myButton = document.getElementById("my-btn");

function handleClick() {
  console.log("버튼이 클릭되었습니다!");
}

// 'myButton' 요소에 'click' 이벤트가 발생하면 'handleClick' 함수를 실행
myButton.addEventListener("click", handleClick);
```

### `addEventListener`의 장점

- **관심사 분리**: HTML은 구조만, JavaScript는 동작만 담당하여 코드가 깔끔해집니다.
- **다중 핸들러 등록**: 하나의 이벤트에 여러 개의 리스너 함수를 '추가'할 수 있습니다. (덮어쓰지 않음)
- **세밀한 제어**: 이벤트 흐름(캡처링/버블링) 등 고급 옵션을 설정할 수 있습니다.

```javascript
// 하나의 클릭 이벤트에 두 개의 리스너 함수를 등록
myButton.addEventListener("click", () => console.log("첫 번째 리스너"));
myButton.addEventListener("click", () => console.log("두 번째 리스너"));
// 클릭 시 두 로그가 모두 출력됨
```

### 이벤트 리스너 제거

`removeEventListener`를 사용하면 등록했던 리스너를 제거할 수 있습니다. 단, **제거하려는 리스너 함수가 등록 시 사용했던 함수와 동일한 참조를 가져야 합니다.** (익명 함수는 제거 불가)

```javascript
// 리스너 제거
myButton.removeEventListener("click", handleClick);
```

---

## 2. 이벤트 객체 (Event Object)

이벤트가 발생하면, 브라우저는 이벤트에 대한 상세 정보를 담은 **이벤트 객체**를 생성하여 리스너 함수에 인자로 전달합니다.

```javascript
myButton.addEventListener("click", function (event) {
  console.log(event); // 이벤트 객체 출력
  console.log(event.type); // 'click'
  console.log(event.target); // 이벤트가 발생한 요소 (<button id="my-btn">)
  console.log(event.currentTarget); // 리스너가 등록된 요소 (<button id="my-btn">)
});
```

### 주요 프로퍼티 및 메서드

- `event.target`: 이벤트가 **실제로 발생한** 가장 안쪽의 요소.
- `event.currentTarget`: 이벤트 리스너가 **등록된** 요소. (이벤트 위임에서 중요)
- `event.preventDefault()`: 브라우저의 기본 동작을 막습니다. (예: `<a>` 태그의 페이지 이동, `<form>`의 제출)
- `event.stopPropagation()`: 이벤트가 상위 요소로 전파(버블링)되는 것을 막습니다.

---

## 3. 폼(Form) 이벤트 처리

`<form>` 요소는 데이터를 서버로 제출하는 고유한 동작을 가집니다. SPA(Single Page Application)에서는 페이지 새로고침 없이 데이터를 처리하기 위해 이 기본 동작을 제어해야 합니다.

- **`submit` 이벤트**: 폼 내부의 `<button type="submit">`을 클릭하거나, 입력 필드에서 Enter 키를 누르면 발생합니다.
- **`event.preventDefault()`**: `submit` 이벤트의 기본 동작인 페이지 새로고침을 막는 데 필수적입니다.
- **`FormData`**: 폼 요소들의 `name` 속성과 `value`를 쉽게 추출할 수 있는 객체를 생성합니다.

```html
<form id="my-form">
  <input type="text" name="username" placeholder="이름" />
  <input type="email" name="email" placeholder="이메일" />
  <button type="submit">제출</button>
</form>
```

```javascript
const myForm = document.getElementById("my-form");

myForm.addEventListener("submit", function (event) {
  // 1. 폼의 기본 제출 동작(새로고침)을 막음
  event.preventDefault();

  // 2. FormData 객체로 폼 데이터 추출
  const formData = new FormData(myForm);

  const username = formData.get("username");
  const email = formData.get("email");

  console.log(`이름: ${username}, 이메일: ${email}`);

  // 이 데이터를 fetch 등을 통해 서버로 비동기 전송할 수 있음
});
```

---

## 4. 이벤트 위임 (Event Delegation)

#이벤트위임 #event-delegation

여러 개의 자식 요소에 각각 이벤트 리스너를 등록하는 대신, 그들의 **부모 요소에 리스너를 하나만 등록**하여 이벤트를 처리하는 패턴입니다. 이벤트 버블링(하위 요소에서 발생한 이벤트가 상위 요소로 전파되는 현상)을 활용합니다.

### 장점

- **성능 향상**: 리스너 개수가 줄어들어 메모리 사용량이 감소합니다.
- **동적 요소 처리**: 나중에 동적으로 추가되는 자식 요소에도 이벤트가 자동으로 적용됩니다.

```html
<ul id="item-list">
  <li>아이템 1 <button class="delete-btn">삭제</button></li>
  <li>아이템 2 <button class="delete-btn">삭제</button></li>
  <li>아이템 3 <button class="delete-btn">삭제</button></li>
</ul>
```

```javascript
const itemList = document.getElementById("item-list");

// 부모인 ul에 이벤트 리스너를 하나만 등록
itemList.addEventListener("click", function (event) {
  // 클릭된 요소(event.target)가 'delete-btn' 클래스를 가졌는지 확인
  if (event.target.classList.contains("delete-btn")) {
    // event.target은 '삭제' 버튼
    // 버튼의 부모인 li 요소를 삭제
    event.target.parentElement.remove();
    console.log("아이템이 삭제되었습니다.");
  }
});

// 새로운 아이템을 추가해도 삭제 버튼이 정상적으로 동작함
const newItem = document.createElement("li");
newItem.innerHTML = '아이템 4 <button class="delete-btn">삭제</button>';
itemList.append(newItem);
```
